// this stuff is used to make vscode happy!
// include, define and extern gets removed
// during vm-generation (see vm_gen.php).

#include "vm.h"
#include "op.h"
#include <assert.h>
#define NEXT return;
#define HALT return;
#define OPCODE(A, ...) void dummy__ ## A ()
extern struct vm *vm;
extern struct vm_arg *_0;
extern struct vm_arg *_1;

// actual code starts here:

OPCODE(NOP) {
  NEXT
}

OPCODE(SUB, 2) {
  switch (_0->type) {
    case OPT_BYTE_PTR: {
      u8 *dst, src;
      break;
    }
    case OPT_WORD_PTR: {
      u16 *dst, src;
      break;
    }
    case OPT_DWORD_PTR: {
      u32 *dst, src;
      break;
    }
  #ifdef VM_USE_QWORD
    case OPT_QWORD_PTR: {
      u64 *dst, src;
      break;
    }
  #endif
  }
  NEXT
}

OPCODE(SET, VID, NUM|STR|SYM) {
  updt_var(vm, _0->data.vid, _1);
  NEXT
}

OPCODE(INI, SYM|VID, NUM) {
  init_inv(vm, _0, _1->data.num);
  NEXT
}

OPCODE(SND, VID|NUM|SYM|STR) {
  if (_0->type == OPT_VID) {
    send_var(vm, _0->data.vid);
    NEXT
  }
  send_val(vm, _0);
  NEXT
}

OPCODE(EXC) {
  exec_inv(vm);
  NEXT
}

OPCODE(DEL, VID) {
  free_var(vm, _0->data.vid);
  NEXT
}

OPCODE(END) {
  free_stk(vm);
  HALT
}
