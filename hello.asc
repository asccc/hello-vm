.mode 4

main:
  push bp                         ; op_push_r64
  mov  bp, sp                     ; op_mov_r64_rm64
  sub  sp, 14                     ; op_sub_rm64_imm64
  mov  [sp+0], 0x68656c6c6f2c2077 ; op_mov_rm64_imm64
  mov  [sp+8], 0x6f726c6421000000 ; op_mov_rm64_imm64
  call echo                       ; op_call
  add  sb, 14                     ; op_add_r64_imm64
  pop  bp                         ; op_pop_r64
  hlt                             ; op_hlt
  
echo:
  push bp                         ; op_push_r64
  mov  bp, sp                     ; op_mov_r64_rm64
  mov  r1, sp                     ; op_mov_r64_rm64
  int  puts                       ; op_int
  pop  bp                         ; op_pop_r64
  ret                             ; op_ret
